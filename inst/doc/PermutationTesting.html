<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Permutation Testing in multivarious</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Permutation Testing in multivarious</h1>



<div id="why-permutation-tests" class="section level1">
<h1>1. Why Permutation Tests?</h1>
<p>Dimensionality reduction raises a fundamental question: <strong>how
many components are real?</strong></p>
<p>A scree plot might show a clear “elbow” at 3 components, but is that
structure genuine or could it arise from noise? Classical heuristics
provide guidance but not formal inference. Permutation testing fills
this gap by answering: <em>“What would this statistic look like if there
were no true structure?”</em></p>
<div id="the-permutation-logic" class="section level2">
<h2>The permutation logic</h2>
<p>The procedure is straightforward: 1. Compute the statistic of
interest on the original data (e.g., variance explained by PC1). 2.
Shuffle the data to destroy the structure being tested. 3. Recompute the
statistic on the shuffled data. 4. Repeat steps 2–3 many times to build
a <strong>null distribution</strong>. 5. Compare the original statistic
to this distribution.</p>
<p>If the observed value is more extreme than (say) 95% of the permuted
values, we reject the null hypothesis at <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>The critical design choice is <em>how</em> to shuffle. Different
analyses require different permutation schemes—shuffling columns for
PCA, shuffling labels for classification, shuffling one block for
cross-block methods. The <code>perm_test()</code> function handles these
details automatically based on the model type.</p>
<hr />
</div>
</div>
<div id="basic-usage" class="section level1">
<h1>2. Basic Usage</h1>
<p>The interface is consistent across model types: fit your model, then
call <code>perm_test()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>X_iris <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>mod_pca <span class="ot">&lt;-</span> <span class="fu">pca</span>(X_iris, <span class="at">ncomp =</span> <span class="dv">4</span>, <span class="at">preproc =</span> <span class="fu">center</span>())</span></code></pre></div>
<p>Now test whether each principal component captures more variance than
expected by chance:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>pt_pca <span class="ot">&lt;-</span> <span class="fu">perm_test</span>(mod_pca,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                    <span class="at">X =</span> X_iris,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                    <span class="at">nperm =</span> <span class="dv">199</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                    <span class="at">comps =</span> <span class="dv">3</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; Pre-calculating reconstructions for stepwise testing...</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; Running 199 permutations sequentially for up to 3 PCA components (alpha=0.050, serial)...</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;   Testing Component 1/3...</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;   Testing Component 2/3...</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;   Testing Component 3/3...</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;   Component 3 p-value (0.055) &gt; alpha (0.050). Stopping sequential testing.</span></span></code></pre></div>
<p>The key arguments:</p>
<ul>
<li><code>X</code> — the original data (required for re-shuffling)</li>
<li><code>nperm</code> — number of permutations (199 here for speed; use
999+ in practice)</li>
<li><code>comps</code> — how many components to test sequentially</li>
<li><code>parallel</code> — enable parallel execution via the
<code>future</code> package</li>
</ul>
<div id="interpreting-results" class="section level2">
<h2>Interpreting results</h2>
<p>The result object contains a <code>component_results</code> table
with p-values and confidence intervals:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">print</span>(pt_pca<span class="sc">$</span>component_results)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;    comp observed  pval lower_ci upper_ci</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 1     1    0.925 0.005    0.682    0.689</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 2     2    0.704 0.01     0.609    0.689</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 3     3    0.766 0.055    0.668    0.785</span></span></code></pre></div>
<p>Components are tested sequentially. By default, testing stops when a
component is non-significant (<span class="math inline">\(p &gt;
0.05\)</span>), since later components are unlikely to be meaningful if
an earlier one fails. Set <code>alpha = 1</code> to force testing all
components.</p>
<hr />
</div>
</div>
<div id="method-specific-behavior" class="section level1">
<h1>3. Method-Specific Behavior</h1>
<p>The <code>perm_test()</code> function dispatches to specialized
methods based on the model class. Each method uses an appropriate test
statistic and shuffle scheme.</p>
<div id="pca" class="section level2">
<h2>PCA</h2>
<p>For PCA, the null hypothesis is that the variables are independent
(no correlation structure). The shuffle scheme permutes each column
independently, destroying any covariance while preserving marginal
distributions.</p>
<p><strong>Statistic:</strong> Fraction of remaining variance explained
by component <span class="math inline">\(a\)</span>: <span class="math display">\[F_a = \frac{\lambda_a}{\sum_{j \ge
a}\lambda_j}\]</span></p>
<p>This tests whether component <span class="math inline">\(a\)</span>
explains more variance than expected given the remaining variance pool.
See Vitale et al. (2017) for theoretical background.</p>
</div>
<div id="discriminant-projector" class="section level2">
<h2>Discriminant projector</h2>
<p>For discriminant analysis, the null hypothesis is that class labels
are unrelated to the features. The shuffle scheme permutes the class
labels.</p>
<p><strong>Statistic:</strong> Classification accuracy (using LDA or
nearest-centroid).</p>
</div>
<div id="cross-projector-cca-pls" class="section level2">
<h2>Cross-projector (CCA, PLS)</h2>
<p>For two-block methods, the null hypothesis is that blocks X and Y are
unrelated. The shuffle scheme permutes rows of one block only, breaking
the correspondence while preserving within-block structure.</p>
<p><strong>Statistic:</strong> Mean squared error of cross-block
prediction (X → Y).</p>
</div>
<div id="multiblock-projector" class="section level2">
<h2>Multiblock projector</h2>
<p>For multi-block analyses, the null hypothesis is that blocks share no
common structure. Each block is shuffled independently.</p>
<p><strong>Statistic:</strong> Consensus measures (leading eigenvalue or
mean absolute correlation between block scores).</p>
<hr />
</div>
</div>
<div id="custom-statistics-and-shuffle-schemes" class="section level1">
<h1>4. Custom Statistics and Shuffle Schemes</h1>
<p>The defaults work well for standard analyses, but you can override
any component of the permutation machinery.</p>
<div id="available-hooks" class="section level2">
<h2>Available hooks</h2>
<ul>
<li><p><strong><code>measure_fun(model_perm, comp_idx, ...)</code></strong>
— Computes the test statistic from a model fitted on permuted data.
Called once per component.</p></li>
<li><p><strong><code>shuffle_fun(data, ...)</code></strong> — Permutes
the data. Must return data in the same structure as the input.</p></li>
<li><p><strong><code>fit_fun(Xtrain, ...)</code></strong> — Re-fits the
model on permuted data. Used by <code>cross_projector</code> and
<code>discriminant_projector</code> when the default fitter (e.g.,
<code>MASS::lda</code>) is not appropriate.</p></li>
</ul>
</div>
<div id="example-custom-statistic" class="section level2">
<h2>Example: custom statistic</h2>
<p>Suppose you want to test whether the <em>first two</em> PCs jointly
explain more variance than chance. You can supply a custom
<code>measure_fun</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>my_pca_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(model_perm, comp_idx, ...) {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="co"># Only compute the joint statistic when testing component 2</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="cf">if</span> (comp_idx <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(model_perm<span class="sc">$</span>sdev) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="fu">sum</span>(model_perm<span class="sc">$</span>sdev[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(model_perm<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (comp_idx <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    model_perm<span class="sc">$</span>sdev[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(model_perm<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="cn">NA_real_</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  }</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># Illustrative call (using default measure here for simplicity)</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>pt_pca_custom <span class="ot">&lt;-</span> <span class="fu">perm_test</span>(mod_pca, <span class="at">X =</span> X_iris, <span class="at">nperm =</span> <span class="dv">50</span>, <span class="at">comps =</span> <span class="dv">2</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>                           <span class="at">parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; Pre-calculating reconstructions for stepwise testing...</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; Running 50 permutations sequentially for up to 2 PCA components (alpha=0.050, serial)...</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;   Testing Component 1/2...</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;   Testing Component 2/2...</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="fu">print</span>(pt_pca_custom<span class="sc">$</span>component_results)</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt;    comp observed   pval lower_ci upper_ci</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; 1     1    0.925 0.0196    0.682    0.692</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; 2     2    0.704 0.0196    0.619    0.690</span></span></code></pre></div>
<p>For testing a single combined statistic rather than sequential
components, set <code>comps = 1</code> and have your
<code>measure_fun</code> compute the combined value directly.</p>
<hr />
</div>
</div>
<div id="parallel-execution" class="section level1">
<h1>5. Parallel Execution</h1>
<p>Permutation tests are embarrassingly parallel—each permutation is
independent. The <code>perm_test()</code> methods use the
<code>future</code> framework, so you control parallelism through your
plan:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">4</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>pt_pca_parallel <span class="ot">&lt;-</span> <span class="fu">perm_test</span>(mod_pca, <span class="at">X =</span> X_iris,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                             <span class="at">nperm =</span> <span class="dv">999</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                             <span class="at">comps =</span> <span class="dv">3</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                             <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span></code></pre></div>
<p>With 4 workers and 999 permutations, each worker handles ~250
permutations concurrently.</p>
<hr />
</div>
<div id="practical-considerations" class="section level1">
<h1>6. Practical Considerations</h1>
<div id="high-dimensional-data" class="section level2">
<h2>High-dimensional data</h2>
<p>When <span class="math inline">\(p \gg n\)</span>, computing full
eigendecompositions repeatedly can be slow. Keep <code>comps</code>
small (you rarely need to test more than 10–20 components), and consider
faster SVD backends if available.</p>
</div>
<div id="non-exchangeable-observations" class="section level2">
<h2>Non-exchangeable observations</h2>
<p>The default shuffles assume observations are exchangeable under the
null. This breaks down for time-series, spatial data, or blocked
designs. In these cases, provide a custom <code>shuffle_fun</code> that
respects the dependence structure (e.g., block permutation, circular
shifts).</p>
</div>
<div id="confidence-intervals" class="section level2">
<h2>Confidence intervals</h2>
<p>The <code>component_results</code> table includes empirical 95% CIs
derived from the permutation distribution. These quantify uncertainty in
the test statistic under the null.</p>
</div>
<div id="the-original-data-is-required" class="section level2">
<h2>The original data is required</h2>
<p>Most methods need the original data (<code>X</code>, <code>Y</code>,
or <code>Xlist</code>) to perform shuffling. Always pass it
explicitly.</p>
</div>
<div id="deprecated-function" class="section level2">
<h2>Deprecated function</h2>
<p>The older <code>perm_ci.pca()</code> is deprecated. Use
<code>perm_test()</code> instead—confidence intervals are included in
the results table.</p>
<hr />
<hr />
</div>
</div>
<div id="references" class="section level1">
<h1>7. References</h1>
<ul>
<li>Vitale, R., Westerhuis, J. A., Næs, T., Smilde, A. K., de Noord, O.
E., &amp; Ferrer, A. (2017). Selecting the number of factors in
principal component analysis by permutation testing— Numerical and
practical aspects. <em>Journal of Chemometrics</em>, 31(10), e2937.
</li>
<li>Good, P. I. (2005). <em>Permutation, Parametric, and Bootstrap Tests
of Hypotheses</em>. Springer Series in Statistics. Springer.</li>
<li>Bengtsson, H. (2021). future: Unified Parallel and Distributed
Processing in R for Everyone. <em>R package version 1.21.0</em>. <a href="https://future.futureverse.org/" class="uri">https://future.futureverse.org/</a></li>
</ul>
<hr />
<p>By providing a unified <code>perm_test</code> interface,
<code>multivarious</code> allows researchers to apply robust,
data-driven significance testing across a range of multivariate modeling
techniques.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
